pipeline {
    agent any

    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }

        stage('SonarQube Analysis') {
            steps {
                script {
                    //defino una variable para que obtener la ruta de sonarscanner que se installo
                    //en global configuration, tool solo es un acronimo que se utiliza para
                    //recuperar la ruta del valor dado(SonarQubeClient)
                    def scannerHome = tool 'SonarQubeClient';
                    withSonarQubeEnv('sonarqubeserver') { // If you have configured more than one global server connection, you can specify its name
                        sh(script: 'mvn -f demo/pom.xml org.sonarsource.scanner.maven:sonar-maven-plugin:3.7.0.1746:sonar') 
                        // sh(script: 'mvn -f demo/pom.xml clean install')
                        // sh(script: '${scannerHome}/bin/sonar-scanner')
                    }
                }
            }
        }

    }
}
